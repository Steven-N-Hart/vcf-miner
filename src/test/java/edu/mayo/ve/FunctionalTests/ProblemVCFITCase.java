package edu.mayo.ve.FunctionalTests;

import com.mongodb.*;
import com.mongodb.util.JSON;
import edu.mayo.concurrency.exceptions.ProcessTerminatedException;
import edu.mayo.util.CompareJSON;
import edu.mayo.util.Tokens;
import edu.mayo.ve.CacheMissException;
import edu.mayo.ve.VCFParser.ErrorStats;
import edu.mayo.ve.VCFParser.VCFErrorFileUtils;
import edu.mayo.ve.VCFParser.VCFParser;
import edu.mayo.ve.index.Index;
import edu.mayo.ve.message.Querry;
import edu.mayo.ve.message.SampleNumberFilter;
import edu.mayo.ve.resources.*;
import edu.mayo.util.MongoConnection;
import edu.mayo.util.SystemProperties;
import org.junit.AfterClass;
import org.junit.Before;
import org.junit.BeforeClass;
import org.junit.Test;

import java.io.File;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import static junit.framework.Assert.assertFalse;
import static junit.framework.TestCase.assertNotNull;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertNotSame;
import static org.junit.Assert.assertTrue;

/**
 * Created with IntelliJ IDEA.
 * User: m102417
 * Date: 1/23/14
 * Time: 9:43 AM
 * This tests VCF files that have been a problem in the past.
 */
public class ProblemVCFITCase {
    
//    public static void main(String[] args) throws IOException, ProcessTerminatedException{
//        ProblemVCFITCase pvcf = new ProblemVCFITCase();
//        pvcf.testAsif100G();
//    }
    
    Mongo m = MongoConnection.getMongo();
    private String user = "test";
    private int overflowThreshold = 50000;


//    @Test
//    public void testZhifu() throws IOException, ProcessTerminatedException{
//        String vcf = "/data/VCFExamples/zs002.variants.vcf";
//        load(vcf, false);
//        delete(vcf);
//    }

    @Test
    public void testAsif100G() throws IOException, ProcessTerminatedException {
        String vcf = "src/test/resources/testData/Asif1000G.vcf";
        //check to see if the type-ahead is indexed.
        DB database = m.getDB("workspace");

        String workspace = load(vcf, false);

        String typeaheadCollectionName = null;
        for (String collectionName: database.getCollectionNames()) {
            if (collectionName.contains(workspace) && collectionName.contains("typeahead")) {
                typeaheadCollectionName = collectionName;
                break;
            }
        }
        assertNotNull(String.format("Could not find typeahead collection for workspace key %s", workspace), typeaheadCollectionName);

        // find type-ahead collection
        DBCollection col = database.getCollection(typeaheadCollectionName);
        Index index = new Index();


        DBObject raw = index.getIndexedFields(col);
        System.out.println("AFTER LOAD");  //HERE TYPEAHEAD SHOULD BE INDEXED
        System.out.println(raw.toString());
        deleteCheck(workspace, 0, 1036);
        raw = index.getIndexedFields(col);
        System.out.println("AFTER DELETE"); //HERE TYPEAHEAD SHOULD NOT BE INDEXED
        System.out.println(raw.toString());
    }

    @Test
    public void testCaseControlSNPEFFHGVSAnnovar() throws IOException, ProcessTerminatedException {
        String vcf = "src/test/resources/testData/Case.control.snpeff.hgvs.annovar.part.vcf";
        String workspace = load(vcf, false);
        //tests.... (note this problem should create an error if it surfaces again)
        deleteCheck(workspace, 0,0);
    }

    //this test takes a LONG time to run, so commenting it out, run manually every now and then if you want to ensure functionality is still correct
    //it is more of a load test...
    //@Test
    public void testCaseControlSNPEFFHGVSAnnovar10k() throws IOException, ProcessTerminatedException {
        System.out.println("Loading 10k of a problem VCF");
        String vcf = "src/test/resources/testData/Case.control.snpeff.hgvs.annovar.10k.vcf.gz";
        String workspace = load(vcf, false);
        //tests
        //make sure there are ~10k records in the collection
        long count = count(workspace);
        assertEquals(9880,count);
        deleteCheck(workspace, 0,0);
    }

    @Test
    public void testAll_SamplesQuerry() throws IOException, ProcessTerminatedException {
        System.out.println("Loading All_Samples.snpeff.annotation.fixed.vcf.gz");
        String vcf = "src/test/resources/testData/All_Samples.snpeff.annotation.fixed.vcf.gz";
        String workspace =  load(vcf, false); //"w3a49942530f0e1e57756b20bc075695f7fd10f90";
        System.out.println("Workspace: " + workspace);
        //tests
        //make sure there are ~10k records in the collection
        long count = count(workspace);
        assertEquals(28324,count);

        System.out.println("Running a Query against the workspace: ");
        ExeQuery eq = new ExeQuery();
        //query that failed:
        //Sending query to server:{"numberResults":"1000","workspace":"w165228bf46fd17f043d0258f2b84220e92a47549","sampleGroups":[],"infoFlagFilters":[],"infoNumberFilters":[],"infoStringFilters":[],"sampleNumberFilters":[{"key":"AD","value":"5","comparator":"$gt","minORmax":"max","includeNulls":false}]}
        Querry q = new Querry();
        q.setNumberResults(1000);
        q.setWorkspace(workspace);
        //"sampleNumberFilters":[{"key":"AD","value":"5","comparator":"$gt","minORmax":"max","includeNulls":false}]
        SampleNumberFilter snf = new SampleNumberFilter("max","AD",5.0,"$gt");
        ArrayList<SampleNumberFilter> snfs = new ArrayList<SampleNumberFilter>( Arrays.asList(snf) );
        q.setSampleNumberFilters(snfs);
        String result = eq.handleBasicQuerry(q);
        System.out.println(result.substring(0,200));
        assertTrue(result.replaceAll("\\s+","").startsWith("{\"totalResults\":22747"));
        deleteCheck(workspace,0,47124); //todo: we need to generate less warnings!
    }

    private long count(String workspace){
        ExeQuery q = new ExeQuery();
        DB db = MongoConnection.getDB();
        DBCollection col = db.getCollection(workspace);
        long count = q.countResults(col, new BasicDBObject());
        return count;
    }

    //this tests loading two files that are the same file one that is compressed and on that is not
    //the contents of the workspaces should be the same.
    @Test
    public void testCompressed() throws IOException, ProcessTerminatedException {
        System.out.println("Testing compression");
        String vcf = "src/test/resources/testData/annotated.functional.vcf";
        String zvcf = "src/test/resources/testData/Annotated.functional.vcf.gz"; //compressed version of the same file
        System.out.println("Loading uncompressed version");
        String workspace = load(vcf, false);
        System.out.println("Loading compressed version");
        String zworkspace = load(vcf, false);
        long count = count(workspace);
        System.out.println("Uncompressed Records Loaded: " + count);
        long zcount = count(zworkspace);
        System.out.println("Compressed Records Loaded: " + zcount);
        assertEquals(count, zcount);
        assertTrue(count != 0);
        deleteCheck(workspace,0,63);//todo: perhaps we should do more with all of these warnings!
        deleteCheck(zworkspace,0,63);
    }


    @Test
    public void testProblemDotMetadata() throws IOException, ProcessTerminatedException {
        String vcf = "src/test/resources/testData/Case.control.snpeff.hgvs.annovar.part300.vcf.gz";
        String workspace = load(vcf, false);
        //tests.... (note this problem should create an error if it surfaces again)
        DB db = MongoConnection.getDB();
        DBCollection col = db.getCollection(workspace);
        assertEquals(197, col.count());

        //check that the metadata object is correct
        String expectedJson = "{ \"_id\" : \"53badebc4206c579de011f31\" , \"HEADER\" : { \"FORMAT\" : { \"PL\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Normalized, Phred-scaled likelihoods for genotypes as defined in the VCF specification\" , \"EntryType\" : \"FORMAT\"} , \"AD\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Allelic depths for the ref and alt alleles in the order listed\" , \"EntryType\" : \"FORMAT\"} , \"GT\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Genotype\" , \"EntryType\" : \"FORMAT\"} , \"GQ\" : { \"number\" : 1 , \"type\" : \"Integer\" , \"Description\" : \"Genotype Quality\" , \"EntryType\" : \"FORMAT\"} , \"DP\" : { \"number\" : 1 , \"type\" : \"Integer\" , \"Description\" : \"Approximate read depth (reads with MQ=255 or with bad mates are filtered)\" , \"EntryType\" : \"FORMAT\"} , \"MLPSAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Maximum likelihood expectation (MLE) for the alternate allele fraction, in the same order as listed, for each individual sample\" , \"EntryType\" : \"FORMAT\"} , \"MLPSAC\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Maximum likelihood expectation (MLE) for the alternate allele count, in the same order as listed, for each individual sample\" , \"EntryType\" : \"FORMAT\"}} , \"INFO\" : { \"Controls_AN\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AN for Controls\" , \"EntryType\" : \"INFO\"} , \"LOF\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Predicted loss of function effects for this variant. Format: 'Gene_Name | Gene_ID | Number_of_transcripts_in_gene | Percent_of_transcripts_affected' \" , \"EntryType\" : \"INFO\"} , \"InbreedingCoeff\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Inbreeding coefficient as estimated from the genotype likelihoods per-sample when compared against the Hardy-Weinberg expectation\" , \"EntryType\" : \"INFO\"} , \"Cases_AF\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AF for Cases\" , \"EntryType\" : \"INFO\"} , \"ReadPosRankSum\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Z-score from Wilcoxon rank sum test of Alt vs. Ref read position bias\" , \"EntryType\" : \"INFO\"} , \"DP\" : { \"number\" : 1 , \"type\" : \"Integer\" , \"Description\" : \"Approximate read depth; some reads may have been filtered\" , \"EntryType\" : \"INFO\"} , \"DS\" : { \"number\" : 0 , \"type\" : \"Flag\" , \"Description\" : \"Were any of the samples downsampled?\" , \"EntryType\" : \"INFO\"} , \"Controls_AF\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AF for Controls\" , \"EntryType\" : \"INFO\"} , \"Cases_AN\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AN for Cases\" , \"EntryType\" : \"INFO\"} , \"Controls_AC\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AC for Controls\" , \"EntryType\" : \"INFO\"} , \"STR\" : { \"number\" : 0 , \"type\" : \"Flag\" , \"Description\" : \"Variant is a short tandem repeat\" , \"EntryType\" : \"INFO\"} , \"BaseQRankSum\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Z-score from Wilcoxon rank sum test of Alt Vs. Ref base qualities\" , \"EntryType\" : \"INFO\"} , \"QD\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Variant Confidence/Quality by Depth\" , \"EntryType\" : \"INFO\"} , \"MQ\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"RMS Mapping Quality\" , \"EntryType\" : \"INFO\"} , \"AC\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Allele count in genotypes, for each ALT allele, in the same order as listed\" , \"EntryType\" : \"INFO\"} , \"Dels\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Fraction of Reads Containing Spanning Deletions\" , \"EntryType\" : \"INFO\"} , \"AF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Allele Frequency, for each ALT allele, in the same order as listed\" , \"EntryType\" : \"INFO\"} , \"AN\" : { \"number\" : 1 , \"type\" : \"Integer\" , \"Description\" : \"Total number of alleles in called genotypes\" , \"EntryType\" : \"INFO\"} , \"HaplotypeScore\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Consistency of the site with at most two segregating haplotypes\" , \"EntryType\" : \"INFO\"} , \"set\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Source VCF for the merged record in CombineVariants\" , \"EntryType\" : \"INFO\"} , \"NMD\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Predicted nonsense mediated decay effects for this variant. Format: 'Gene_Name | Gene_ID | Number_of_transcripts_in_gene | Percent_of_transcripts_affected' \" , \"EntryType\" : \"INFO\"} , \"MLEAC\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Maximum likelihood expectation (MLE) for the allele counts (not necessarily the same as the AC), for each ALT allele, in the same order as listed\" , \"EntryType\" : \"INFO\"} , \"MLEAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Maximum likelihood expectation (MLE) for the allele frequency (not necessarily the same as the AF), for each ALT allele, in the same order as listed\" , \"EntryType\" : \"INFO\"} , \"FS\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Phred-scaled p-value using Fisher's exact test to detect strand bias\" , \"EntryType\" : \"INFO\"} , \"Approved_Gene_Name\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The official gene name that has been approved by the HGNC and is publicly available\" , \"EntryType\" : \"INFO\"} , \"Cases_AC\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Original AC for Cases\" , \"EntryType\" : \"INFO\"} , \"BGI200_Danish_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Estimated Minor Allele Frequency\" , \"EntryType\" : \"INFO\"} , \"MQRankSum\" : { \"number\" : 1 , \"type\" : \"Float\" , \"Description\" : \"Z-score From Wilcoxon rank sum test of Alt vs. Ref read mapping qualities\" , \"EntryType\" : \"INFO\"} , \"RU\" : { \"number\" : 1 , \"type\" : \"String\" , \"Description\" : \"Tandem repeat unit (bases)\" , \"EntryType\" : \"INFO\"} , \"RPA\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Number of times tandem repeat unit is repeated, for each allele (including reference)\" , \"EntryType\" : \"INFO\"} , \"MQ0\" : { \"number\" : 1 , \"type\" : \"Integer\" , \"Description\" : \"Total Mapping Quality Zero Reads\" , \"EntryType\" : \"INFO\"} , \"EFF\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Predicted effects for this variant.Format: 'Effect ( Effect_Impact | Functional_Class | Codon_Change | Amino_Acid_Change| Amino_Acid_length | Gene_Name | Transcript_BioType | Gene_Coding | Transcript_ID | Exon_Rank  | Genotype_Number [ | ERRORS | WARNINGS ] )' \" , \"EntryType\" : \"INFO\"} , \"UniprotID\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The UniProt identifier provided by the EBI.\" , \"EntryType\" : \"INFO\"} , \"bior_mt_mt\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"PolyPhen_TERM\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The PolyPhen prediction.\" , \"EntryType\" : \"INFO\"} , \"HapMap_CEU_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Other allele frequency(Utah residents with Northern and Western European ancestry from the CEPH collection)\" , \"EntryType\" : \"INFO\"} , \"HapMap_YRI_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Other Allele Frequency(Han Chinese in Beijing China)\" , \"EntryType\" : \"INFO\"} , \"ESP6500_AFR_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"African American Minor Allele Frequency (in percent)\" , \"EntryType\" : \"INFO\"} , \"dbSNP_DiseaseVariant\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Variant disease name\" , \"EntryType\" : \"INFO\"} , \"1000Genomes_EUR_AF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Allele Frequency for samples from EUR based on AC/AN\" , \"EntryType\" : \"INFO\"} , \"bior_phyloP_phyloP\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"bior_lrt_lrt\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"COSMIC_Mutation_AA\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The change that has occurred in the peptide sequence as a result of the mutation\" , \"EntryType\" : \"INFO\"} , \"bior_pp2_pp2\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"1000Genomes_ASN_AF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Allele Frequency for samples from ASN based on AC/AN\" , \"EntryType\" : \"INFO\"} , \"OMIM_Disease\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Phenotypes observed\" , \"EntryType\" : \"INFO\"} , \"SIFT_TERM\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The SIFT prediction.\" , \"EntryType\" : \"INFO\"} , \"COSMIC_strand\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Strand based on GRCh37 genome build\" , \"EntryType\" : \"INFO\"} , \"PolyPhen_Score\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"The PolyPhen score.\" , \"EntryType\" : \"INFO\"} , \"1000Genomes_AMR_AF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Allele Frequency for samples from AMR based on AC/AN\" , \"EntryType\" : \"INFO\"} , \"HapMap_JPT_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Other Allele Frequency(Japanese in Tokyo Japan)\" , \"EntryType\" : \"INFO\"} , \"COSMIC_Mutation_ID\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"This id is used to identify a mutation within the COSMIC database and is assigned as the mutation is curated\" , \"EntryType\" : \"INFO\"} , \"dbSNP_SuspectRegion\" : { \"number\" : \".\" , \"type\" : \"Integer\" , \"Description\" : \"Variant Suspect Reason Codes (may be more than one value added together) 0 - unspecified, 1 - Paralog, 2 - byEST, 4 - oldAlign, 8 - Para_EST, 16 - 1kg_failed, 1024 - other\" , \"EntryType\" : \"INFO\"} , \"bior_sift_SIFTscore\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"ESP6500_EUR_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"European American Minor Allele Frequency (in percent)\" , \"EntryType\" : \"INFO\"} , \"SIFT_Score\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"The SIFT score.\" , \"EntryType\" : \"INFO\"} , \"1000Genomes_AFR_AF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Allele Frequency for samples from AFR based on AC/AN\" , \"EntryType\" : \"INFO\"} , \"dbSNP_ClinicalSig\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"Variant Clinical Significance, 0 - unknown, 1 - untested, 2 - non-pathogenic, 3 - probable-non-pathogenic, 4 - probable-pathogenic, 5 - pathogenic, 6 - drug-response, 7 - histocompatibility, 255 - other\" , \"EntryType\" : \"INFO\"} , \"COSMIC_Mutation_CDS\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"The change that has occurred in the nucleotide sequence as a result of the mutation\" , \"EntryType\" : \"INFO\"} , \"bior_gerp_gerp\" : { \"number\" : \".\" , \"type\" : \"String\" , \"Description\" : \"BioR property file missing description\" , \"EntryType\" : \"INFO\"} , \"HapMap_CHB_MAF\" : { \"number\" : \".\" , \"type\" : \"Float\" , \"Description\" : \"Other Allele Frequency(Yoruban in Ibadan  Nigeria)\" , \"EntryType\" : \"INFO\"}}} , \"SAMPLES\" : { \"s_Mayo_TN_CC_254\" : 189 , \"s_Mayo_TN_CC_255\" : 190 , \"s_Mayo_TN_CC_252\" : 187 , \"s_Mayo_TN_CC_253\" : 188 , \"s_Mayo_TN_CC_250\" : 185 , \"s_Mayo_TN_CC_251\" : 186 , \"s_Mayo_TN_CC_530\" : 493 , \"s_Mayo_TN_CC_537\" : 500 , \"s_Mayo_TN_CC_538\" : 501 , \"s_Mayo_TN_CC_535\" : 498 , \"s_Mayo_TN_CC_536\" : 499 , \"s_Mayo_TN_CC_533\" : 496 , \"s_Mayo_TN_CC_534\" : 497 , \"s_Mayo_TN_CC_531\" : 494 , \"s_Mayo_TN_CC_532\" : 495 , \"s_Mayo_TN_CC_259\" : 194 , \"s_Mayo_TN_CC_258\" : 193 , \"s_Mayo_TN_CC_257\" : 192 , \"s_Mayo_TN_CC_539\" : 502 , \"s_Mayo_TN_CC_256\" : 191 , \"s_Mayo_TN_CC_241\" : 175 , \"s_Mayo_TN_CC_242\" : 176 , \"s_Mayo_TN_CC_243\" : 177 , \"s_Mayo_TN_CC_244\" : 178 , \"s_Mayo_TN_CC_240\" : 174 , \"s_Mayo_TN_CC_524\" : 486 , \"s_Mayo_TN_CC_525\" : 487 , \"s_Mayo_TN_CC_526\" : 488 , \"s_Mayo_TN_CC_527\" : 489 , \"s_Mayo_TN_CC_520\" : 482 , \"s_Mayo_TN_CC_521\" : 483 , \"s_Mayo_TN_CC_522\" : 484 , \"s_Mayo_TN_CC_523\" : 485 , \"s_Mayo_TN_CC_249\" : 183 , \"s_Mayo_TN_CC_246\" : 180 , \"s_Mayo_TN_CC_528\" : 490 , \"s_Mayo_TN_CC_245\" : 179 , \"s_Mayo_TN_CC_529\" : 491 , \"s_Mayo_TN_CC_248\" : 182 , \"s_Mayo_TN_CC_247\" : 181 , \"s_Mayo_TN_CC_232\" : 165 , \"s_Mayo_TN_CC_233\" : 166 , \"s_Mayo_TN_CC_230\" : 163 , \"s_Mayo_TN_CC_231\" : 164 , \"s_Mayo_TN_CC_798\" : 787 , \"s_Mayo_TN_CC_797\" : 786 , \"s_Mayo_TN_CC_796\" : 785 , \"s_Mayo_TN_CC_795\" : 784 , \"s_Mayo_TN_CC_799\" : 788 , \"s_Mayo_TN_CC_511\" : 472 , \"s_Mayo_TN_CC_790\" : 779 , \"s_Mayo_TN_CC_512\" : 473 , \"s_Mayo_TN_CC_510\" : 471 , \"s_Mayo_TN_CC_793\" : 782 , \"s_Mayo_TN_CC_515\" : 476 , \"s_Mayo_TN_CC_794\" : 783 , \"s_Mayo_TN_CC_516\" : 477 , \"s_Mayo_TN_CC_791\" : 780 , \"s_Mayo_TN_CC_513\" : 474 , \"s_Mayo_TN_CC_792\" : 781 , \"s_Mayo_TN_CC_514\" : 475 , \"s_Mayo_TN_CC_237\" : 170 , \"s_Mayo_TN_CC_519\" : 480 , \"s_Mayo_TN_CC_236\" : 169 , \"s_Mayo_TN_CC_235\" : 168 , \"s_Mayo_TN_CC_517\" : 478 , \"s_Mayo_TN_CC_234\" : 167 , \"s_Mayo_TN_CC_518\" : 479 , \"s_Mayo_TN_CC_239\" : 172 , \"s_Mayo_TN_CC_238\" : 171 , \"s_Mayo_TN_CC_220\" : 152 , \"s_Mayo_TN_CC_221\" : 153 , \"s_Mayo_TN_CC_222\" : 154 , \"s_Mayo_TN_CC_785\" : 773 , \"s_Mayo_TN_CC_784\" : 772 , \"s_Mayo_TN_CC_787\" : 775 , \"s_Mayo_TN_CC_786\" : 774 , \"s_Mayo_TN_CC_789\" : 777 , \"s_Mayo_TN_CC_788\" : 776 , \"s_Mayo_TN_CC_500\" : 460 , \"s_Mayo_TN_CC_501\" : 461 , \"s_Mayo_TN_CC_502\" : 462 , \"s_Mayo_TN_CC_780\" : 768 , \"s_Mayo_TN_CC_503\" : 463 , \"s_Mayo_TN_CC_781\" : 769 , \"s_Mayo_TN_CC_504\" : 464 , \"s_Mayo_TN_CC_782\" : 770 , \"s_Mayo_TN_CC_505\" : 465 , \"s_Mayo_TN_CC_783\" : 771 , \"s_Mayo_TN_CC_224\" : 156 , \"s_Mayo_TN_CC_506\" : 466 , \"s_Mayo_TN_CC_223\" : 155 , \"s_Mayo_TN_CC_507\" : 467 , \"s_Mayo_TN_CC_226\" : 158 , \"s_Mayo_TN_CC_508\" : 468 , \"s_Mayo_TN_CC_225\" : 157 , \"s_Mayo_TN_CC_509\" : 469 , \"s_Mayo_TN_CC_228\" : 160 , \"s_Mayo_TN_CC_227\" : 159 , \"s_Mayo_TN_CC_229\" : 161 , \"s_Mayo_TN_CC_291\" : 230 , \"s_Mayo_TN_CC_573\" : 540 , \"s_Mayo_TN_CC_779\" : 766 , \"s_Mayo_TN_CC_290\" : 229 , \"s_Mayo_TN_CC_574\" : 541 , \"s_Mayo_TN_CC_571\" : 538 , \"s_Mayo_TN_CC_777\" : 764 , \"s_Mayo_TN_CC_572\" : 539 , \"s_Mayo_TN_CC_778\" : 765 , \"s_Mayo_TN_CC_775\" : 762 , \"s_Mayo_TN_CC_570\" : 537 , \"s_Mayo_TN_CC_776\" : 763 , \"s_Mayo_TN_CC_773\" : 760 , \"s_Mayo_TN_CC_774\" : 761 , \"s_Mayo_TN_CC_299\" : 238 , \"s_Mayo_TN_CC_298\" : 237 , \"s_Mayo_TN_CC_297\" : 236 , \"s_Mayo_TN_CC_296\" : 235 , \"s_Mayo_TN_CC_295\" : 234 , \"s_Mayo_TN_CC_294\" : 233 , \"s_Mayo_TN_CC_293\" : 232 , \"s_Mayo_TN_CC_292\" : 231 , \"s_Mayo_TN_CC_772\" : 759 , \"s_Mayo_TN_CC_771\" : 758 , \"s_Mayo_TN_CC_770\" : 757 , \"s_Mayo_TN_CC_579\" : 546 , \"s_Mayo_TN_CC_578\" : 545 , \"s_Mayo_TN_CC_577\" : 544 , \"s_Mayo_TN_CC_576\" : 543 , \"s_Mayo_TN_CC_575\" : 542 , \"s_Mayo_TN_CC_560\" : 526 , \"s_Mayo_TN_CC_766\" : 752 , \"s_Mayo_TN_CC_561\" : 527 , \"s_Mayo_TN_CC_767\" : 753 , \"s_Mayo_TN_CC_280\" : 218 , \"s_Mayo_TN_CC_562\" : 528 , \"s_Mayo_TN_CC_768\" : 754 , \"s_Mayo_TN_CC_563\" : 529 , \"s_Mayo_TN_CC_769\" : 755 , \"s_Mayo_TN_CC_762\" : 748 , \"s_Mayo_TN_CC_763\" : 749 , \"s_Mayo_TN_CC_764\" : 750 , \"s_Mayo_TN_CC_765\" : 751 , \"s_Mayo_TN_CC_286\" : 224 , \"s_Mayo_TN_CC_285\" : 223 , \"s_Mayo_TN_CC_288\" : 226 , \"s_Mayo_TN_CC_287\" : 225 , \"s_Mayo_TN_CC_282\" : 220 , \"s_Mayo_TN_CC_281\" : 219 , \"s_Mayo_TN_CC_284\" : 222 , \"s_Mayo_TN_CC_283\" : 221 , \"s_Mayo_TN_CC_289\" : 227 , \"s_Mayo_TN_CC_569\" : 535 , \"s_Mayo_TN_CC_568\" : 534 , \"s_Mayo_TN_CC_761\" : 747 , \"s_Mayo_TN_CC_760\" : 746 , \"s_Mayo_TN_CC_565\" : 531 , \"s_Mayo_TN_CC_564\" : 530 , \"s_Mayo_TN_CC_567\" : 533 , \"s_Mayo_TN_CC_566\" : 532 , \"s_Mayo_TN_CC_753\" : 738 , \"s_Mayo_TN_CC_754\" : 739 , \"s_Mayo_TN_CC_751\" : 736 , \"s_Mayo_TN_CC_752\" : 737 , \"s_Mayo_TN_CC_551\" : 516 , \"s_Mayo_TN_CC_757\" : 742 , \"s_Mayo_TN_CC_552\" : 517 , \"s_Mayo_TN_CC_758\" : 743 , \"s_Mayo_TN_CC_755\" : 740 , \"s_Mayo_TN_CC_550\" : 515 , \"s_Mayo_TN_CC_756\" : 741 , \"s_Mayo_TN_CC_273\" : 210 , \"s_Mayo_TN_CC_272\" : 209 , \"s_Mayo_TN_CC_271\" : 208 , \"s_Mayo_TN_CC_759\" : 744 , \"s_Mayo_TN_CC_270\" : 207 , \"s_Mayo_TN_CC_277\" : 214 , \"s_Mayo_TN_CC_276\" : 213 , \"s_Mayo_TN_CC_275\" : 212 , \"s_Mayo_TN_CC_274\" : 211 , \"s_Mayo_TN_CC_278\" : 215 , \"s_Mayo_TN_CC_279\" : 216 , \"s_Mayo_TN_CC_556\" : 521 , \"s_Mayo_TN_CC_555\" : 520 , \"s_Mayo_TN_CC_554\" : 519 , \"s_Mayo_TN_CC_553\" : 518 , \"s_Mayo_TN_CC_750\" : 735 , \"s_Mayo_TN_CC_559\" : 524 , \"s_Mayo_TN_CC_558\" : 523 , \"s_Mayo_TN_CC_557\" : 522 , \"s_Mayo_TN_CC_740\" : 724 , \"s_Mayo_TN_CC_741\" : 725 , \"s_Mayo_TN_CC_742\" : 726 , \"s_Mayo_TN_CC_743\" : 727 , \"s_Mayo_TN_CC_744\" : 728 , \"s_Mayo_TN_CC_745\" : 729 , \"s_Mayo_TN_CC_540\" : 504 , \"s_Mayo_TN_CC_746\" : 730 , \"s_Mayo_TN_CC_541\" : 505 , \"s_Mayo_TN_CC_747\" : 731 , \"s_Mayo_TN_CC_260\" : 196 , \"s_Mayo_TN_CC_748\" : 732 , \"s_Mayo_TN_CC_749\" : 733 , \"s_Mayo_TN_CC_262\" : 198 , \"s_Mayo_TN_CC_261\" : 197 , \"s_Mayo_TN_CC_264\" : 200 , \"s_Mayo_TN_CC_263\" : 199 , \"s_Mayo_TN_CC_266\" : 202 , \"s_Mayo_TN_CC_265\" : 201 , \"s_Mayo_TN_CC_267\" : 203 , \"s_Mayo_TN_CC_268\" : 204 , \"s_Mayo_TN_CC_269\" : 205 , \"s_Mayo_TN_CC_543\" : 507 , \"s_Mayo_TN_CC_542\" : 506 , \"s_Mayo_TN_CC_545\" : 509 , \"s_Mayo_TN_CC_544\" : 508 , \"s_Mayo_TN_CC_547\" : 511 , \"s_Mayo_TN_CC_546\" : 510 , \"s_Mayo_TN_CC_549\" : 513 , \"s_Mayo_TN_CC_548\" : 512 , \"s_Mayo_TN_CC_738\" : 721 , \"s_Mayo_TN_CC_737\" : 720 , \"s_Mayo_TN_CC_739\" : 722 , \"s_Mayo_TN_CC_734\" : 717 , \"s_Mayo_TN_CC_733\" : 716 , \"s_Mayo_TN_CC_736\" : 719 , \"s_Mayo_TN_CC_735\" : 718 , \"s_Mayo_TN_CC_730\" : 713 , \"s_Mayo_TN_CC_732\" : 715 , \"s_Mayo_TN_CC_731\" : 714 , \"s_Mayo_TN_CC_729\" : 711 , \"s_Mayo_TN_CC_728\" : 710 , \"s_Mayo_TN_CC_727\" : 709 , \"s_Mayo_TN_CC_726\" : 708 , \"s_Mayo_TN_CC_725\" : 707 , \"s_Mayo_TN_CC_724\" : 706 , \"s_Mayo_TN_CC_723\" : 705 , \"s_Mayo_TN_CC_722\" : 704 , \"s_Mayo_TN_CC_721\" : 703 , \"s_Mayo_TN_CC_720\" : 702 , \"s_Mayo_TN_CC_716\" : 697 , \"s_Mayo_TN_CC_715\" : 696 , \"s_Mayo_TN_CC_718\" : 699 , \"s_Mayo_TN_CC_717\" : 698 , \"s_Mayo_TN_CC_719\" : 700 , \"s_Mayo_TN_CC_710\" : 691 , \"s_Mayo_TN_CC_712\" : 693 , \"s_Mayo_TN_CC_711\" : 692 , \"s_Mayo_TN_CC_714\" : 695 , \"s_Mayo_TN_CC_713\" : 694 , \"s_Mayo_TN_CC_707\" : 687 , \"s_Mayo_TN_CC_706\" : 686 , \"s_Mayo_TN_CC_705\" : 685 , \"s_Mayo_TN_CC_704\" : 684 , \"s_Mayo_TN_CC_709\" : 689 , \"s_Mayo_TN_CC_708\" : 688 , \"s_Mayo_TN_CC_703\" : 683 , \"s_Mayo_TN_CC_702\" : 682 , \"s_Mayo_TN_CC_701\" : 681 , \"s_Mayo_TN_CC_700\" : 680 , \"s_Mayo_TN_CC_588\" : 556 , \"s_Mayo_TN_CC_589\" : 557 , \"s_Mayo_TN_CC_586\" : 554 , \"s_Mayo_TN_CC_587\" : 555 , \"s_Mayo_TN_CC_585\" : 553 , \"s_Mayo_TN_CC_584\" : 552 , \"s_Mayo_TN_CC_583\" : 551 , \"s_Mayo_TN_CC_582\" : 550 , \"s_Mayo_TN_CC_581\" : 549 , \"s_Mayo_TN_CC_580\" : 548 , \"s_Mayo_TN_CC_597\" : 566 , \"s_Mayo_TN_CC_598\" : 567 , \"s_Mayo_TN_CC_599\" : 568 , \"s_Mayo_TN_CC_594\" : 563 , \"s_Mayo_TN_CC_593\" : 562 , \"s_Mayo_TN_CC_596\" : 565 , \"s_Mayo_TN_CC_595\" : 564 , \"s_Mayo_TN_CC_590\" : 559 , \"s_Mayo_TN_CC_592\" : 561 , \"s_Mayo_TN_CC_591\" : 560 , \"s_Mayo_TN_CC_203\" : 133 , \"s_Mayo_TN_CC_204\" : 134 , \"s_Mayo_TN_CC_201\" : 131 , \"s_Mayo_TN_CC_202\" : 132 , \"s_Mayo_TN_CC_207\" : 137 , \"s_Mayo_TN_CC_208\" : 138 , \"s_Mayo_TN_CC_205\" : 135 , \"s_Mayo_TN_CC_206\" : 136 , \"s_Mayo_TN_CC_209\" : 139 , \"s_Mayo_TN_CC_200\" : 130 , \"s_Mayo_TN_CC_212\" : 143 , \"s_Mayo_TN_CC_213\" : 144 , \"s_Mayo_TN_CC_214\" : 145 , \"s_Mayo_TN_CC_215\" : 146 , \"s_Mayo_TN_CC_216\" : 147 , \"s_Mayo_TN_CC_217\" : 148 , \"s_Mayo_TN_CC_218\" : 149 , \"s_Mayo_TN_CC_219\" : 150 , \"s_Mayo_TN_CC_211\" : 142 , \"s_Mayo_TN_CC_210\" : 141 , \"s_Mayo_TN_CC_37\" : 316 , \"s_Mayo_TN_CC_677\" : 654 , \"s_Mayo_TN_CC_36\" : 305 , \"s_Mayo_TN_CC_676\" : 653 , \"s_Mayo_TN_CC_35\" : 294 , \"s_Mayo_TN_CC_675\" : 652 , \"s_Mayo_TN_CC_34\" : 283 , \"s_Mayo_TN_CC_674\" : 651 , \"s_Mayo_TN_CC_33\" : 272 , \"s_Mayo_TN_CC_32\" : 261 , \"s_Mayo_TN_CC_31\" : 250 , \"s_Mayo_TN_CC_679\" : 656 , \"s_Mayo_TN_CC_30\" : 239 , \"s_Mayo_TN_CC_678\" : 655 , \"s_Mayo_TN_CC_159\" : 84 , \"s_Mayo_TN_CC_350\" : 295 , \"s_Mayo_TN_CC_157\" : 82 , \"s_Mayo_TN_CC_158\" : 83 , \"s_Mayo_TN_CC_353\" : 298 , \"s_Mayo_TN_CC_354\" : 299 , \"s_Mayo_TN_CC_39\" : 338 , \"s_Mayo_TN_CC_351\" : 296 , \"s_Mayo_TN_CC_38\" : 327 , \"s_Mayo_TN_CC_352\" : 297 , \"s_Mayo_TN_CC_358\" : 303 , \"s_Mayo_TN_CC_152\" : 77 , \"s_Mayo_TN_CC_357\" : 302 , \"s_Mayo_TN_CC_151\" : 76 , \"s_Mayo_TN_CC_356\" : 301 , \"s_Mayo_TN_CC_150\" : 75 , \"s_Mayo_TN_CC_355\" : 300 , \"s_Mayo_TN_CC_156\" : 81 , \"s_Mayo_TN_CC_155\" : 80 , \"s_Mayo_TN_CC_154\" : 79 , \"s_Mayo_TN_CC_359\" : 304 , \"s_Mayo_TN_CC_153\" : 78 , \"s_Mayo_TN_CC_40\" : 349 , \"s_Mayo_TN_CC_672\" : 649 , \"s_Mayo_TN_CC_673\" : 650 , \"s_Mayo_TN_CC_670\" : 647 , \"s_Mayo_TN_CC_671\" : 648 , \"s_Mayo_TN_CC_24\" : 173 , \"s_Mayo_TN_CC_664\" : 640 , \"s_Mayo_TN_CC_23\" : 162 , \"s_Mayo_TN_CC_663\" : 639 , \"s_Mayo_TN_CC_26\" : 195 , \"s_Mayo_TN_CC_666\" : 642 , \"s_Mayo_TN_CC_25\" : 184 , \"s_Mayo_TN_CC_665\" : 641 , \"s_Mayo_TN_CC_20\" : 129 , \"s_Mayo_TN_CC_668\" : 644 , \"s_Mayo_TN_CC_667\" : 643 , \"s_Mayo_TN_CC_22\" : 151 , \"s_Mayo_TN_CC_21\" : 140 , \"s_Mayo_TN_CC_669\" : 645 , \"s_Mayo_TN_CC_146\" : 70 , \"s_Mayo_TN_CC_147\" : 71 , \"s_Mayo_TN_CC_148\" : 72 , \"s_Mayo_TN_CC_149\" : 73 , \"s_Mayo_TN_CC_340\" : 284 , \"s_Mayo_TN_CC_28\" : 217 , \"s_Mayo_TN_CC_341\" : 285 , \"s_Mayo_TN_CC_27\" : 206 , \"s_Mayo_TN_CC_342\" : 286 , \"s_Mayo_TN_CC_343\" : 287 , \"s_Mayo_TN_CC_29\" : 228 , \"s_Mayo_TN_CC_345\" : 289 , \"s_Mayo_TN_CC_344\" : 288 , \"s_Mayo_TN_CC_347\" : 291 , \"s_Mayo_TN_CC_141\" : 65 , \"s_Mayo_TN_CC_346\" : 290 , \"s_Mayo_TN_CC_140\" : 64 , \"s_Mayo_TN_CC_349\" : 293 , \"s_Mayo_TN_CC_143\" : 67 , \"s_Mayo_TN_CC_348\" : 292 , \"s_Mayo_TN_CC_142\" : 66 , \"s_Mayo_TN_CC_145\" : 69 , \"s_Mayo_TN_CC_144\" : 68 , \"s_Mayo_TN_CC_660\" : 636 , \"s_Mayo_TN_CC_661\" : 637 , \"s_Mayo_TN_CC_662\" : 638 , \"s_Mayo_TN_CC_55\" : 514 , \"s_Mayo_TN_CC_809\" : 799 , \"s_Mayo_TN_CC_54\" : 503 , \"s_Mayo_TN_CC_808\" : 798 , \"s_Mayo_TN_CC_53\" : 492 , \"s_Mayo_TN_CC_807\" : 797 , \"s_Mayo_TN_CC_52\" : 481 , \"s_Mayo_TN_CC_806\" : 796 , \"s_Mayo_TN_CC_59\" : 558 , \"s_Mayo_TN_CC_699\" : 678 , \"s_Mayo_TN_CC_805\" : 795 , \"s_Mayo_TN_CC_58\" : 547 , \"s_Mayo_TN_CC_698\" : 677 , \"s_Mayo_TN_CC_804\" : 794 , \"s_Mayo_TN_CC_57\" : 536 , \"s_Mayo_TN_CC_697\" : 676 , \"s_Mayo_TN_CC_803\" : 793 , \"s_Mayo_TN_CC_56\" : 525 , \"s_Mayo_TN_CC_696\" : 675 , \"s_Mayo_TN_CC_802\" : 792 , \"s_Mayo_TN_CC_375\" : 322 , \"s_Mayo_TN_CC_801\" : 791 , \"s_Mayo_TN_CC_376\" : 323 , \"s_Mayo_TN_CC_800\" : 790 , \"s_Mayo_TN_CC_373\" : 320 , \"s_Mayo_TN_CC_374\" : 321 , \"s_Mayo_TN_CC_371\" : 318 , \"s_Mayo_TN_CC_372\" : 319 , \"s_Mayo_TN_CC_179\" : 106 , \"s_Mayo_TN_CC_370\" : 317 , \"s_Mayo_TN_CC_178\" : 105 , \"s_Mayo_TN_CC_177\" : 104 , \"s_Mayo_TN_CC_176\" : 103 , \"s_Mayo_TN_CC_175\" : 102 , \"s_Mayo_TN_CC_174\" : 101 , \"s_Mayo_TN_CC_379\" : 326 , \"s_Mayo_TN_CC_173\" : 100 , \"s_Mayo_TN_CC_418\" : 369 , \"s_Mayo_TN_CC_378\" : 325 , \"s_Mayo_TN_CC_172\" : 99 , \"s_Mayo_TN_CC_419\" : 370 , \"s_Mayo_TN_CC_377\" : 324 , \"s_Mayo_TN_CC_171\" : 98 , \"s_Mayo_TN_CC_416\" : 367 , \"s_Mayo_TN_CC_170\" : 97 , \"s_Mayo_TN_CC_694\" : 673 , \"s_Mayo_TN_CC_417\" : 368 , \"s_Mayo_TN_CC_695\" : 674 , \"s_Mayo_TN_CC_414\" : 365 , \"s_Mayo_TN_CC_692\" : 671 , \"s_Mayo_TN_CC_415\" : 366 , \"s_Mayo_TN_CC_693\" : 672 , \"s_Mayo_TN_CC_412\" : 363 , \"s_Mayo_TN_CC_61\" : 580 , \"s_Mayo_TN_CC_690\" : 669 , \"s_Mayo_TN_CC_413\" : 364 , \"s_Mayo_TN_CC_62\" : 591 , \"s_Mayo_TN_CC_691\" : 670 , \"s_Mayo_TN_CC_410\" : 361 , \"s_Mayo_TN_CC_411\" : 362 , \"s_Mayo_TN_CC_60\" : 569 , \"s_Mayo_TN_CC_819\" : 810 , \"s_Mayo_TN_CC_42\" : 371 , \"s_Mayo_TN_CC_818\" : 809 , \"s_Mayo_TN_CC_41\" : 360 , \"s_Mayo_TN_CC_689\" : 667 , \"s_Mayo_TN_CC_44\" : 393 , \"s_Mayo_TN_CC_43\" : 382 , \"s_Mayo_TN_CC_815\" : 806 , \"s_Mayo_TN_CC_46\" : 415 , \"s_Mayo_TN_CC_686\" : 664 , \"s_Mayo_TN_CC_814\" : 805 , \"s_Mayo_TN_CC_45\" : 404 , \"s_Mayo_TN_CC_685\" : 663 , \"s_Mayo_TN_CC_817\" : 808 , \"s_Mayo_TN_CC_48\" : 437 , \"s_Mayo_TN_CC_688\" : 666 , \"s_Mayo_TN_CC_816\" : 807 , \"s_Mayo_TN_CC_47\" : 426 , \"s_Mayo_TN_CC_687\" : 665 , \"s_Mayo_TN_CC_811\" : 802 , \"s_Mayo_TN_CC_362\" : 308 , \"s_Mayo_TN_CC_810\" : 801 , \"s_Mayo_TN_CC_363\" : 309 , \"s_Mayo_TN_CC_49\" : 448 , \"s_Mayo_TN_CC_813\" : 804 , \"s_Mayo_TN_CC_364\" : 310 , \"s_Mayo_TN_CC_812\" : 803 , \"s_Mayo_TN_CC_365\" : 311 , \"s_Mayo_TN_CC_168\" : 94 , \"s_Mayo_TN_CC_169\" : 95 , \"s_Mayo_TN_CC_360\" : 306 , \"s_Mayo_TN_CC_361\" : 307 , \"s_Mayo_TN_CC_165\" : 91 , \"s_Mayo_TN_CC_164\" : 90 , \"s_Mayo_TN_CC_167\" : 93 , \"s_Mayo_TN_CC_166\" : 92 , \"s_Mayo_TN_CC_407\" : 357 , \"s_Mayo_TN_CC_367\" : 313 , \"s_Mayo_TN_CC_161\" : 87 , \"s_Mayo_TN_CC_408\" : 358 , \"s_Mayo_TN_CC_366\" : 312 , \"s_Mayo_TN_CC_160\" : 86 , \"s_Mayo_TN_CC_409\" : 359 , \"s_Mayo_TN_CC_369\" : 315 , \"s_Mayo_TN_CC_163\" : 89 , \"s_Mayo_TN_CC_368\" : 314 , \"s_Mayo_TN_CC_162\" : 88 , \"s_Mayo_TN_CC_403\" : 353 , \"s_Mayo_TN_CC_681\" : 659 , \"s_Mayo_TN_CC_404\" : 354 , \"s_Mayo_TN_CC_682\" : 660 , \"s_Mayo_TN_CC_405\" : 355 , \"s_Mayo_TN_CC_683\" : 661 , \"s_Mayo_TN_CC_406\" : 356 , \"s_Mayo_TN_CC_684\" : 662 , \"s_Mayo_TN_CC_400\" : 350 , \"s_Mayo_TN_CC_401\" : 351 , \"s_Mayo_TN_CC_50\" : 459 , \"s_Mayo_TN_CC_402\" : 352 , \"s_Mayo_TN_CC_51\" : 470 , \"s_Mayo_TN_CC_680\" : 658 , \"s_Mayo_TN_CC_394\" : 343 , \"s_Mayo_TN_CC_116\" : 37 , \"s_Mayo_TN_CC_820\" : 812 , \"s_Mayo_TN_CC_393\" : 342 , \"s_Mayo_TN_CC_115\" : 36 , \"s_Mayo_TN_CC_392\" : 341 , \"s_Mayo_TN_CC_114\" : 35 , \"s_Mayo_TN_CC_638\" : 611 , \"s_Mayo_TN_CC_391\" : 340 , \"s_Mayo_TN_CC_113\" : 34 , \"s_Mayo_TN_CC_639\" : 612 , \"s_Mayo_TN_CC_823\" : 815 , \"s_Mayo_TN_CC_398\" : 347 , \"s_Mayo_TN_CC_824\" : 816 , \"s_Mayo_TN_CC_397\" : 346 , \"s_Mayo_TN_CC_119\" : 40 , \"s_Mayo_TN_CC_821\" : 813 , \"s_Mayo_TN_CC_396\" : 345 , \"s_Mayo_TN_CC_118\" : 39 , \"s_Mayo_TN_CC_822\" : 814 , \"s_Mayo_TN_CC_395\" : 344 , \"s_Mayo_TN_CC_117\" : 38 , \"s_Mayo_TN_CC_827\" : 819 , \"s_Mayo_TN_CC_632\" : 605 , \"s_Mayo_TN_CC_828\" : 820 , \"s_Mayo_TN_CC_633\" : 606 , \"s_Mayo_TN_CC_825\" : 817 , \"s_Mayo_TN_CC_630\" : 603 , \"s_Mayo_TN_CC_826\" : 818 , \"s_Mayo_TN_CC_631\" : 604 , \"s_Mayo_TN_CC_430\" : 383 , \"s_Mayo_TN_CC_390\" : 339 , \"s_Mayo_TN_CC_636\" : 609 , \"s_Mayo_TN_CC_431\" : 384 , \"s_Mayo_TN_CC_637\" : 610 , \"s_Mayo_TN_CC_829\" : 821 , \"s_Mayo_TN_CC_634\" : 607 , \"s_Mayo_TN_CC_635\" : 608 , \"s_Mayo_TN_CC_435\" : 388 , \"s_Mayo_TN_CC_434\" : 387 , \"s_Mayo_TN_CC_433\" : 386 , \"s_Mayo_TN_CC_432\" : 385 , \"s_Mayo_TN_CC_439\" : 392 , \"s_Mayo_TN_CC_438\" : 391 , \"s_Mayo_TN_CC_437\" : 390 , \"s_Mayo_TN_CC_436\" : 389 , \"s_Mayo_TN_CC_399\" : 348 , \"s_Mayo_TN_CC_111\" : 32 , \"s_Mayo_TN_CC_112\" : 33 , \"s_Mayo_TN_CC_110\" : 31 , \"s_Mayo_TN_CC_381\" : 329 , \"s_Mayo_TN_CC_103\" : 23 , \"s_Mayo_TN_CC_627\" : 599 , \"s_Mayo_TN_CC_380\" : 328 , \"s_Mayo_TN_CC_102\" : 22 , \"s_Mayo_TN_CC_628\" : 600 , \"s_Mayo_TN_CC_830\" : 823 , \"s_Mayo_TN_CC_383\" : 331 , \"s_Mayo_TN_CC_105\" : 25 , \"s_Mayo_TN_CC_629\" : 601 , \"s_Mayo_TN_CC_831\" : 824 , \"s_Mayo_TN_CC_382\" : 330 , \"s_Mayo_TN_CC_104\" : 24 , \"s_Mayo_TN_CC_832\" : 825 , \"s_Mayo_TN_CC_385\" : 333 , \"s_Mayo_TN_CC_107\" : 27 , \"s_Mayo_TN_CC_833\" : 826 , \"s_Mayo_TN_CC_384\" : 332 , \"s_Mayo_TN_CC_106\" : 26 , \"s_Mayo_TN_CC_834\" : 827 , \"s_Mayo_TN_CC_387\" : 335 , \"s_Mayo_TN_CC_109\" : 29 , \"s_Mayo_TN_CC_835\" : 828 , \"s_Mayo_TN_CC_386\" : 334 , \"s_Mayo_TN_CC_108\" : 28 , \"s_Mayo_TN_CC_836\" : 829 , \"s_Mayo_TN_CC_837\" : 830 , \"s_Mayo_TN_CC_620\" : 592 , \"s_Mayo_TN_CC_838\" : 831 , \"s_Mayo_TN_CC_621\" : 593 , \"s_Mayo_TN_CC_839\" : 832 , \"s_Mayo_TN_CC_622\" : 594 , \"s_Mayo_TN_CC_623\" : 595 , \"s_Mayo_TN_CC_624\" : 596 , \"s_Mayo_TN_CC_625\" : 597 , \"s_Mayo_TN_CC_420\" : 372 , \"s_Mayo_TN_CC_626\" : 598 , \"s_Mayo_TN_CC_422\" : 374 , \"s_Mayo_TN_CC_421\" : 373 , \"s_Mayo_TN_CC_424\" : 376 , \"s_Mayo_TN_CC_423\" : 375 , \"s_Mayo_TN_CC_426\" : 378 , \"s_Mayo_TN_CC_425\" : 377 , \"s_Mayo_TN_CC_428\" : 380 , \"s_Mayo_TN_CC_427\" : 379 , \"s_Mayo_TN_CC_388\" : 336 , \"s_Mayo_TN_CC_429\" : 381 , \"s_Mayo_TN_CC_389\" : 337 , \"s_Mayo_TN_CC_100\" : 20 , \"s_Mayo_TN_CC_101\" : 21 , \"s_Mayo_TN_CC_845\" : 839 , \"s_Mayo_TN_CC_18\" : 107 , \"s_Mayo_TN_CC_846\" : 840 , \"s_Mayo_TN_CC_19\" : 118 , \"s_Mayo_TN_CC_843\" : 837 , \"s_Mayo_TN_CC_16\" : 85 , \"s_Mayo_TN_CC_844\" : 838 , \"s_Mayo_TN_CC_17\" : 96 , \"s_Mayo_TN_CC_139\" : 62 , \"s_Mayo_TN_CC_841\" : 835 , \"s_Mayo_TN_CC_138\" : 61 , \"s_Mayo_TN_CC_842\" : 836 , \"s_Mayo_TN_CC_137\" : 60 , \"s_Mayo_TN_CC_136\" : 59 , \"s_Mayo_TN_CC_840\" : 834 , \"s_Mayo_TN_CC_135\" : 58 , \"s_Mayo_TN_CC_10\" : 19 , \"s_Mayo_TN_CC_452\" : 407 , \"s_Mayo_TN_CC_658\" : 633 , \"s_Mayo_TN_CC_11\" : 30 , \"s_Mayo_TN_CC_453\" : 408 , \"s_Mayo_TN_CC_659\" : 634 , \"s_Mayo_TN_CC_450\" : 405 , \"s_Mayo_TN_CC_656\" : 631 , \"s_Mayo_TN_CC_451\" : 406 , \"s_Mayo_TN_CC_657\" : 632 , \"s_Mayo_TN_CC_849\" : 843 , \"s_Mayo_TN_CC_14\" : 63 , \"s_Mayo_TN_CC_654\" : 629 , \"s_Mayo_TN_CC_15\" : 74 , \"s_Mayo_TN_CC_655\" : 630 , \"s_Mayo_TN_CC_847\" : 841 , \"s_Mayo_TN_CC_12\" : 41 , \"s_Mayo_TN_CC_652\" : 627 , \"s_Mayo_TN_CC_848\" : 842 , \"s_Mayo_TN_CC_13\" : 52 , \"s_Mayo_TN_CC_653\" : 628 , \"s_Mayo_TN_CC_651\" : 626 , \"s_Mayo_TN_CC_650\" : 625 , \"s_Mayo_TN_CC_459\" : 414 , \"s_Mayo_TN_CC_458\" : 413 , \"s_Mayo_TN_CC_457\" : 412 , \"s_Mayo_TN_CC_456\" : 411 , \"s_Mayo_TN_CC_455\" : 410 , \"s_Mayo_TN_CC_454\" : 409 , \"s_Mayo_TN_CC_133\" : 56 , \"s_Mayo_TN_CC_134\" : 57 , \"s_Mayo_TN_CC_131\" : 54 , \"s_Mayo_TN_CC_132\" : 55 , \"s_Mayo_TN_CC_130\" : 53 , \"s_Mayo_TN_CC_854\" : 849 , \"s_Mayo_TN_CC_05\" : 14 , \"s_Mayo_TN_CC_129\" : 51 , \"s_Mayo_TN_CC_855\" : 850 , \"s_Mayo_TN_CC_06\" : 15 , \"s_Mayo_TN_CC_128\" : 50 , \"s_Mayo_TN_CC_856\" : 851 , \"s_Mayo_TN_CC_07\" : 16 , \"s_Mayo_TN_CC_857\" : 852 , \"s_Mayo_TN_CC_08\" : 17 , \"s_Mayo_TN_CC_850\" : 845 , \"s_Mayo_TN_CC_09\" : 18 , \"s_Mayo_TN_CC_125\" : 47 , \"s_Mayo_TN_CC_649\" : 623 , \"s_Mayo_TN_CC_851\" : 846 , \"s_Mayo_TN_CC_124\" : 46 , \"s_Mayo_TN_CC_852\" : 847 , \"s_Mayo_TN_CC_127\" : 49 , \"s_Mayo_TN_CC_853\" : 848 , \"s_Mayo_TN_CC_126\" : 48 , \"s_Mayo_TN_CC_645\" : 619 , \"s_Mayo_TN_CC_440\" : 394 , \"s_Mayo_TN_CC_646\" : 620 , \"s_Mayo_TN_CC_441\" : 395 , \"s_Mayo_TN_CC_647\" : 621 , \"s_Mayo_TN_CC_442\" : 396 , \"s_Mayo_TN_CC_648\" : 622 , \"s_Mayo_TN_CC_858\" : 853 , \"s_Mayo_TN_CC_01\" : 10 , \"s_Mayo_TN_CC_641\" : 615 , \"s_Mayo_TN_CC_859\" : 854 , \"s_Mayo_TN_CC_02\" : 11 , \"s_Mayo_TN_CC_642\" : 616 , \"s_Mayo_TN_CC_03\" : 12 , \"s_Mayo_TN_CC_643\" : 617 , \"s_Mayo_TN_CC_04\" : 13 , \"s_Mayo_TN_CC_644\" : 618 , \"s_Mayo_TN_CC_448\" : 402 , \"s_Mayo_TN_CC_447\" : 401 , \"s_Mayo_TN_CC_640\" : 614 , \"s_Mayo_TN_CC_449\" : 403 , \"s_Mayo_TN_CC_444\" : 398 , \"s_Mayo_TN_CC_443\" : 397 , \"s_Mayo_TN_CC_446\" : 400 , \"s_Mayo_TN_CC_445\" : 399 , \"s_Mayo_TN_CC_120\" : 42 , \"s_Mayo_TN_CC_121\" : 43 , \"s_Mayo_TN_CC_122\" : 44 , \"s_Mayo_TN_CC_123\" : 45 , \"s_Mayo_TN_CC_860\" : 856 , \"s_Mayo_TN_CC_869\" : 865 , \"s_Mayo_TN_CC_862\" : 858 , \"s_Mayo_TN_CC_861\" : 857 , \"s_Mayo_TN_CC_864\" : 860 , \"s_Mayo_TN_CC_863\" : 859 , \"s_Mayo_TN_CC_866\" : 862 , \"s_Mayo_TN_CC_865\" : 861 , \"s_Mayo_TN_CC_868\" : 864 , \"s_Mayo_TN_CC_867\" : 863 , \"s_Mayo_TN_CC_870\" : 867 , \"s_Mayo_TN_CC_871\" : 868 , \"s_Mayo_TN_CC_875\" : 872 , \"s_Mayo_TN_CC_874\" : 871 , \"s_Mayo_TN_CC_873\" : 870 , \"s_Mayo_TN_CC_872\" : 869 , \"s_Mayo_TN_CC_879\" : 876 , \"s_Mayo_TN_CC_878\" : 875 , \"s_Mayo_TN_CC_877\" : 874 , \"s_Mayo_TN_CC_876\" : 873 , \"s_Mayo_TN_CC_880\" : 878 , \"s_Mayo_TN_CC_881\" : 879 , \"s_Mayo_TN_CC_882\" : 880 , \"s_Mayo_TN_CC_613\" : 584 , \"s_Mayo_TN_CC_612\" : 583 , \"s_Mayo_TN_CC_615\" : 586 , \"s_Mayo_TN_CC_614\" : 585 , \"s_Mayo_TN_CC_611\" : 582 , \"s_Mayo_TN_CC_610\" : 581 , \"s_Mayo_TN_CC_888\" : 886 , \"s_Mayo_TN_CC_887\" : 885 , \"s_Mayo_TN_CC_884\" : 882 , \"s_Mayo_TN_CC_617\" : 588 , \"s_Mayo_TN_CC_883\" : 881 , \"s_Mayo_TN_CC_616\" : 587 , \"s_Mayo_TN_CC_886\" : 884 , \"s_Mayo_TN_CC_619\" : 590 , \"s_Mayo_TN_CC_885\" : 883 , \"s_Mayo_TN_CC_618\" : 589 , \"s_Mayo_TN_CC_604\" : 574 , \"s_Mayo_TN_CC_603\" : 573 , \"s_Mayo_TN_CC_602\" : 572 , \"s_Mayo_TN_CC_601\" : 571 , \"s_Mayo_TN_CC_600\" : 570 , \"s_Mayo_TN_CC_609\" : 579 , \"s_Mayo_TN_CC_608\" : 578 , \"s_Mayo_TN_CC_607\" : 577 , \"s_Mayo_TN_CC_606\" : 576 , \"s_Mayo_TN_CC_605\" : 575 , \"s_Mayo_TN_CC_82\" : 811 , \"s_Mayo_TN_CC_81\" : 800 , \"s_Mayo_TN_CC_84\" : 833 , \"s_Mayo_TN_CC_83\" : 822 , \"s_Mayo_TN_CC_190\" : 119 , \"s_Mayo_TN_CC_80\" : 789 , \"s_Mayo_TN_CC_191\" : 120 , \"s_Mayo_TN_CC_192\" : 121 , \"s_Mayo_TN_CC_193\" : 122 , \"s_Mayo_TN_CC_194\" : 123 , \"s_Mayo_TN_CC_195\" : 124 , \"s_Mayo_TN_CC_196\" : 125 , \"s_Mayo_TN_CC_197\" : 126 , \"s_Mayo_TN_CC_198\" : 127 , \"s_Mayo_TN_CC_199\" : 128 , \"s_Mayo_TN_CC_78\" : 767 , \"s_Mayo_TN_CC_79\" : 778 , \"s_Mayo_TN_CC_74\" : 723 , \"s_Mayo_TN_CC_75\" : 734 , \"s_Mayo_TN_CC_76\" : 745 , \"s_Mayo_TN_CC_77\" : 756 , \"s_Mayo_TN_CC_73\" : 712 , \"s_Mayo_TN_CC_72\" : 701 , \"s_Mayo_TN_CC_71\" : 690 , \"s_Mayo_TN_CC_70\" : 679 , \"s_Mayo_TN_CC_180\" : 108 , \"s_Mayo_TN_CC_181\" : 109 , \"s_Mayo_TN_CC_184\" : 112 , \"s_Mayo_TN_CC_185\" : 113 , \"s_Mayo_TN_CC_182\" : 110 , \"s_Mayo_TN_CC_183\" : 111 , \"s_Mayo_TN_CC_188\" : 116 , \"s_Mayo_TN_CC_189\" : 117 , \"s_Mayo_TN_CC_186\" : 114 , \"s_Mayo_TN_CC_187\" : 115 , \"s_Mayo_TN_CC_69\" : 668 , \"s_Mayo_TN_CC_67\" : 646 , \"s_Mayo_TN_CC_68\" : 657 , \"s_Mayo_TN_CC_65\" : 624 , \"s_Mayo_TN_CC_66\" : 635 , \"s_Mayo_TN_CC_63\" : 602 , \"s_Mayo_TN_CC_64\" : 613 , \"s_Mayo_TN_CC_96\" : 894 , \"s_Mayo_TN_CC_97\" : 895 , \"s_Mayo_TN_CC_98\" : 896 , \"s_Mayo_TN_CC_99\" : 897 , \"s_Mayo_TN_CC_91\" : 889 , \"s_Mayo_TN_CC_90\" : 888 , \"s_Mayo_TN_CC_95\" : 893 , \"s_Mayo_TN_CC_94\" : 892 , \"s_Mayo_TN_CC_93\" : 891 , \"s_Mayo_TN_CC_92\" : 890 , \"s_Mayo_TN_CC_87\" : 866 , \"s_Mayo_TN_CC_88\" : 877 , \"s_Mayo_TN_CC_85\" : 844 , \"s_Mayo_TN_CC_86\" : 855 , \"s_Mayo_TN_CC_89\" : 887 , \"s_Mayo_TN_CC_469\" : 425 , \"s_Mayo_TN_CC_467\" : 423 , \"s_Mayo_TN_CC_468\" : 424 , \"s_Mayo_TN_CC_465\" : 421 , \"s_Mayo_TN_CC_466\" : 422 , \"s_Mayo_TN_CC_464\" : 420 , \"s_Mayo_TN_CC_463\" : 419 , \"s_Mayo_TN_CC_462\" : 418 , \"s_Mayo_TN_CC_461\" : 417 , \"s_Mayo_TN_CC_460\" : 416 , \"s_Mayo_TN_CC_476\" : 433 , \"s_Mayo_TN_CC_477\" : 434 , \"s_Mayo_TN_CC_478\" : 435 , \"s_Mayo_TN_CC_479\" : 436 , \"s_Mayo_TN_CC_473\" : 430 , \"s_Mayo_TN_CC_472\" : 429 , \"s_Mayo_TN_CC_475\" : 432 , \"s_Mayo_TN_CC_474\" : 431 , \"s_Mayo_TN_CC_471\" : 428 , \"s_Mayo_TN_CC_470\" : 427 , \"s_Mayo_TN_CC_489\" : 447 , \"s_Mayo_TN_CC_487\" : 445 , \"s_Mayo_TN_CC_488\" : 446 , \"s_Mayo_TN_CC_482\" : 440 , \"s_Mayo_TN_CC_481\" : 439 , \"s_Mayo_TN_CC_480\" : 438 , \"s_Mayo_TN_CC_486\" : 444 , \"s_Mayo_TN_CC_485\" : 443 , \"s_Mayo_TN_CC_484\" : 442 , \"s_Mayo_TN_CC_483\" : 441 , \"s_Mayo_TN_CC_498\" : 457 , \"s_Mayo_TN_CC_499\" : 458 , \"s_Mayo_TN_CC_491\" : 450 , \"s_Mayo_TN_CC_490\" : 449 , \"s_Mayo_TN_CC_493\" : 452 , \"s_Mayo_TN_CC_492\" : 451 , \"s_Mayo_TN_CC_495\" : 454 , \"s_Mayo_TN_CC_494\" : 453 , \"s_Mayo_TN_CC_497\" : 456 , \"s_Mayo_TN_CC_496\" : 455 , \"s_Mayo_TN_CC_308\" : 248 , \"s_Mayo_TN_CC_309\" : 249 , \"s_Mayo_TN_CC_306\" : 246 , \"s_Mayo_TN_CC_307\" : 247 , \"s_Mayo_TN_CC_304\" : 244 , \"s_Mayo_TN_CC_305\" : 245 , \"s_Mayo_TN_CC_302\" : 242 , \"s_Mayo_TN_CC_303\" : 243 , \"s_Mayo_TN_CC_300\" : 240 , \"s_Mayo_TN_CC_301\" : 241 , \"s_Mayo_TN_CC_319\" : 260 , \"s_Mayo_TN_CC_315\" : 256 , \"s_Mayo_TN_CC_316\" : 257 , \"s_Mayo_TN_CC_317\" : 258 , \"s_Mayo_TN_CC_318\" : 259 , \"s_Mayo_TN_CC_311\" : 252 , \"s_Mayo_TN_CC_312\" : 253 , \"s_Mayo_TN_CC_313\" : 254 , \"s_Mayo_TN_CC_314\" : 255 , \"s_Mayo_TN_CC_310\" : 251 , \"s_Mayo_TN_CC_324\" : 266 , \"s_Mayo_TN_CC_325\" : 267 , \"s_Mayo_TN_CC_322\" : 264 , \"s_Mayo_TN_CC_323\" : 265 , \"s_Mayo_TN_CC_328\" : 270 , \"s_Mayo_TN_CC_329\" : 271 , \"s_Mayo_TN_CC_326\" : 268 , \"s_Mayo_TN_CC_327\" : 269 , \"s_Mayo_TN_CC_321\" : 263 , \"s_Mayo_TN_CC_320\" : 262 , \"s_Mayo_TN_CC_333\" : 276 , \"s_Mayo_TN_CC_334\" : 277 , \"s_Mayo_TN_CC_335\" : 278 , \"s_Mayo_TN_CC_336\" : 279 , \"s_Mayo_TN_CC_337\" : 280 , \"s_Mayo_TN_CC_338\" : 281 , \"s_Mayo_TN_CC_339\" : 282 , \"s_Mayo_TN_CC_330\" : 273 , \"s_Mayo_TN_CC_332\" : 275 , \"s_Mayo_TN_CC_331\" : 274} , \"FORMAT\" : { \"min\" : { \"PL\" : 1 , \"AD\" : 1 , \"GT\" : 1 , \"GQ\" : 1 , \"DP\" : 1 , \"MLPSAF\" : 1 , \"MLPSAC\" : 1} , \"max\" : { \"PL\" : 1 , \"AD\" : 1 , \"GT\" : 1 , \"GQ\" : 1 , \"DP\" : 1 , \"MLPSAF\" : 1 , \"MLPSAC\" : 1}} , \"owner\" : \"test\" , \"key\" : \"wbfb9548164f615b80d8821bda933e3899561565e\" , \"timestamp\" : \"2014-07-07T17:54+0000\" , \"alias\" : \"Case.control.snpeff.hgvs.annovar.part300.vcf.gz\"}";
        DBObject expecteddb = (DBObject) JSON.parse(expectedJson);
        expecteddb.removeField(Tokens.KEY); //these will never sync up because it is unique to the load
        expecteddb.removeField("timestamp");
        expecteddb.removeField("_id");
        MetaData meta = new MetaData();
        String resultJson = meta.getWorkspaceJSON(workspace);
        DBObject resultdb = (DBObject) JSON.parse(resultJson);
        resultdb.removeField(Tokens.KEY); //these will never sync up because it is unique to the load
        resultdb.removeField("timestamp");
        resultdb.removeField("_id");
        CompareJSON.equals(expecteddb,resultdb);

        deleteCheck(workspace, 0, 0);
    }


    @Test
    public void testExcessiveWarningsNotPresent() throws IOException, ProcessTerminatedException {
        //certain versions of pipes had excessive warnings when custom logic failed on a VCF, this tests that the version of pipes is correct
        String vcf = "src/test/resources/testData/failCustomLogic.vcf";
        String workspace = load(vcf, false);
        System.out.println(workspace);
        //not completing test because it turned out to be redundant to the pipes test.

    }


    public String load(String inputVCF, boolean reporting) throws IOException, ProcessTerminatedException {
        System.out.println("Make sure to have MongoDB up and running on localhost (or wherever specified in your sys.properties file) before you try to run this functional test!");
        System.out.println("ProblemVCFITCase.Provision a new workspace...");
        Provision prov = new Provision();
        String alias = getAlias(inputVCF);
        String json = prov.provision(user,alias);
        DBObject w = (DBObject) JSON.parse(json);
        String workspaceID = (String) w.get(Tokens.KEY);
        System.out.println("Workspace provisioned with key: " + workspaceID);

        System.out.println("ProblemVCF.Loading data into a new workspace...");
        VCFParser parser = new VCFParser();
        parser.parse(null, inputVCF, workspaceID, overflowThreshold, false, reporting);  //put true in the second to last param for verbose load reporting
        parser.setTypeAhead(null);//remove the type-ahead, because it could be consuming too much ram...
        return workspaceID;
    }

    private String getAlias(String path){
        String[] tokens = path.split("/");
        return tokens[tokens.length-1];
    }

    public static void deleteCheck(String workspaceID, int errors, int warnings) throws IOException {
        System.out.println("Checking Statistics: ");
        SystemProperties sysprop = new SystemProperties();
        String tmp = sysprop.get("TEMPDIR");
        ErrorStats stats = VCFErrorFileUtils.calculateErrorStatistics(tmp + File.separator + workspaceID + ".errors");
        assertEquals(errors, stats.getErrors());
        assertEquals(warnings, stats.getWarnings());
        System.out.println("Deleting Workspace: " + workspaceID);
        Workspace w = new Workspace();
        w.deleteWorkspace(workspaceID);

    }

}
